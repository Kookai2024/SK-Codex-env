[
  {
    "id": "users",
    "name": "users",
    "type": "auth",
    "system": false,
    "schema": [
      {
        "id": "name",
        "name": "name",
        "type": "text",
        "required": true,
        "presentable": true,
        "unique": false,
        "options": {
          "min": null,
          "max": null,
          "pattern": ""
        }
      },
      {
        "id": "email",
        "name": "email",
        "type": "email",
        "required": true,
        "presentable": true,
        "unique": true,
        "options": {
          "exceptDomains": null,
          "onlyDomains": null
        }
      },
      {
        "id": "role",
        "name": "role",
        "type": "select",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "maxSelect": 1,
          "values": [
            "admin",
            "member",
            "guest"
          ],
          "displayFields": null
        }
      },
      {
        "id": "department",
        "name": "department",
        "type": "text",
        "required": false,
        "presentable": false,
        "unique": false,
        "options": {
          "min": null,
          "max": null,
          "pattern": ""
        }
      },
      {
        "id": "join_date",
        "name": "join_date",
        "type": "date",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "min": "",
          "max": ""
        }
      }
    ],
    "indexes": [
      "CREATE INDEX idx_users_email ON users (email)"
    ],
    "listRule": "@request.auth.role = \"admin\"",
    "viewRule": "@request.auth.role = \"admin\" || @request.auth.id = id",
    "createRule": "@request.auth.role = \"admin\"",
    "updateRule": "@request.auth.role = \"admin\" || @request.auth.id = id",
    "deleteRule": "@request.auth.role = \"admin\"",
    "options": {
      "allowEmailAuth": true,
      "allowOAuth2Auth": false,
      "allowUsernameAuth": false,
      "requireEmail": true,
      "exceptEmailDomains": null,
      "manageRule": "(@request.auth.id != \"\" && @request.auth.role = \"admin\") || @request.auth.id = id",
      "minPasswordLength": 8,
      "onlyEmailDomains": null
    }
  },
  {
    "id": "projects",
    "name": "projects",
    "type": "base",
    "system": false,
    "schema": [
      {
        "id": "name",
        "name": "name",
        "type": "text",
        "required": true,
        "presentable": true,
        "unique": false,
        "options": {
          "min": null,
          "max": null,
          "pattern": ""
        }
      },
      {
        "id": "code",
        "name": "code",
        "type": "text",
        "required": true,
        "presentable": true,
        "unique": true,
        "options": {
          "min": null,
          "max": null,
          "pattern": "^[A-Z0-9_-]{2,10}$"
        }
      },
      {
        "id": "description",
        "name": "description",
        "type": "text",
        "required": false,
        "presentable": false,
        "unique": false,
        "options": {
          "min": null,
          "max": null,
          "pattern": ""
        }
      },
      {
        "id": "status",
        "name": "status",
        "type": "select",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "maxSelect": 1,
          "values": [
            "planning",
            "in_progress",
            "delayed",
            "completed"
          ],
          "displayFields": null
        }
      }
    ],
    "indexes": [
      "CREATE UNIQUE INDEX idx_projects_code ON projects (code)"
    ],
    "listRule": "@request.auth.id != \"\"",
    "viewRule": "@request.auth.id != \"\"",
    "createRule": "@request.auth.role = \"admin\"",
    "updateRule": "@request.auth.role = \"admin\"",
    "deleteRule": "@request.auth.role = \"admin\""
  },
  {
    "id": "todos",
    "name": "todos",
    "type": "base",
    "system": false,
    "schema": [
      {
        "id": "assignee",
        "name": "assignee",
        "type": "relation",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "collectionId": "users",
          "cascadeDelete": false,
          "minSelect": null,
          "maxSelect": 1,
          "displayFields": [
            "name"
          ]
        }
      },
      {
        "id": "project",
        "name": "project",
        "type": "relation",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "collectionId": "projects",
          "cascadeDelete": false,
          "minSelect": null,
          "maxSelect": 1,
          "displayFields": [
            "code",
            "name"
          ]
        }
      },
      {
        "id": "title",
        "name": "title",
        "type": "text",
        "required": true,
        "presentable": true,
        "unique": false,
        "options": {
          "min": 1,
          "max": 120,
          "pattern": ""
        }
      },
      {
        "id": "description",
        "name": "description",
        "type": "text",
        "required": false,
        "presentable": false,
        "unique": false,
        "options": {
          "min": null,
          "max": null,
          "pattern": ""
        }
      },
      {
        "id": "status",
        "name": "status",
        "type": "select",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "maxSelect": 1,
          "values": [
            "prework",
            "design",
            "hold",
            "po_placed",
            "incoming"
          ],
          "displayFields": null
        }
      },
      {
        "id": "notes",
        "name": "notes",
        "type": "text",
        "required": false,
        "presentable": false,
        "unique": false,
        "options": {
          "min": null,
          "max": null,
          "pattern": ""
        }
      },
      {
        "id": "due_date",
        "name": "due_date",
        "type": "date",
        "required": false,
        "presentable": false,
        "unique": false,
        "options": {
          "min": "",
          "max": ""
        }
      },
      {
        "id": "lock_deadline",
        "name": "lock_deadline",
        "type": "date",
        "required": false,
        "presentable": false,
        "unique": false,
        "options": {
          "min": "",
          "max": ""
        }
      }
    ],
    "indexes": [
      "CREATE INDEX idx_todos_assignee ON todos (assignee)",
      "CREATE INDEX idx_todos_project ON todos (project)",
      "CREATE INDEX idx_todos_status ON todos (status)",
      "CREATE INDEX idx_todos_due_date ON todos (due_date)"
    ],
    "listRule": "@request.auth.role = \"admin\" || @request.auth.id = assignee",
    "viewRule": "@request.auth.role = \"admin\" || @request.auth.id = assignee",
    "createRule": "(@request.auth.role = \"admin\") || (@request.auth.role = \"member\" && @request.auth.id = assignee)",
    "updateRule": "(@request.auth.role = \"admin\") || (@request.auth.id = assignee && datetime(@now) <= datetime(coalesce(lock_deadline, datetime(created, '+1 day', 'start of day'))))",
    "deleteRule": "@request.auth.role = \"admin\""
  },
  {
    "id": "attendance",
    "name": "attendance",
    "type": "base",
    "system": false,
    "schema": [
      {
        "id": "user",
        "name": "user",
        "type": "relation",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "collectionId": "users",
          "cascadeDelete": false,
          "minSelect": null,
          "maxSelect": 1,
          "displayFields": [
            "name"
          ]
        }
      },
      {
        "id": "work_date",
        "name": "work_date",
        "type": "date",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "min": "",
          "max": ""
        }
      },
      {
        "id": "check_in_at",
        "name": "check_in_at",
        "type": "date",
        "required": false,
        "presentable": false,
        "unique": false,
        "options": {
          "min": "",
          "max": ""
        }
      },
      {
        "id": "check_out_at",
        "name": "check_out_at",
        "type": "date",
        "required": false,
        "presentable": false,
        "unique": false,
        "options": {
          "min": "",
          "max": ""
        }
      },
      {
        "id": "status",
        "name": "status",
        "type": "select",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "maxSelect": 1,
          "values": [
            "in_progress",
            "completed",
            "absence"
          ],
          "displayFields": null
        }
      },
      {
        "id": "note",
        "name": "note",
        "type": "text",
        "required": false,
        "presentable": false,
        "unique": false,
        "options": {
          "min": null,
          "max": null,
          "pattern": ""
        }
      }
    ],
    "indexes": [
      "CREATE INDEX idx_attendance_user ON attendance (user)",
      "CREATE INDEX idx_attendance_work_date ON attendance (work_date)"
    ],
    "listRule": "@request.auth.role = \"admin\" || @request.auth.id = user",
    "viewRule": "@request.auth.role = \"admin\" || @request.auth.id = user",
    "createRule": "@request.auth.id = user",
    "updateRule": "@request.auth.role = \"admin\"",
    "deleteRule": "@request.auth.role = \"admin\""
  },
  {
    "id": "reports",
    "name": "reports",
    "type": "base",
    "system": false,
    "schema": [
      {
        "id": "owner",
        "name": "owner",
        "type": "relation",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "collectionId": "users",
          "cascadeDelete": false,
          "minSelect": null,
          "maxSelect": 1,
          "displayFields": [
            "name"
          ]
        }
      },
      {
        "id": "week_start",
        "name": "week_start",
        "type": "date",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "min": "",
          "max": ""
        }
      },
      {
        "id": "week_end",
        "name": "week_end",
        "type": "date",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "min": "",
          "max": ""
        }
      },
      {
        "id": "summary_this_week",
        "name": "summary_this_week",
        "type": "text",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "min": null,
          "max": null,
          "pattern": ""
        }
      },
      {
        "id": "summary_next_week",
        "name": "summary_next_week",
        "type": "text",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "min": null,
          "max": null,
          "pattern": ""
        }
      },
      {
        "id": "export_path",
        "name": "export_path",
        "type": "text",
        "required": false,
        "presentable": false,
        "unique": false,
        "options": {
          "min": null,
          "max": null,
          "pattern": ""
        }
      }
    ],
    "indexes": [
      "CREATE INDEX idx_reports_owner ON reports (owner)",
      "CREATE UNIQUE INDEX idx_reports_week ON reports (week_start, week_end)"
    ],
    "listRule": "@request.auth.role = \"admin\" || @request.auth.id = owner",
    "viewRule": "@request.auth.role = \"admin\" || @request.auth.id = owner",
    "createRule": "@request.auth.role = \"admin\"",
    "updateRule": "@request.auth.role = \"admin\"",
    "deleteRule": "@request.auth.role = \"admin\""
  }
]
